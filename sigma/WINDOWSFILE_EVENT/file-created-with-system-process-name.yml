title: File Created with System Process Name
author: Sander Wiebing
detection:
- SELECT * FROM WINDOWSFILE_EVENT WHERE (($FileName LIKE "%\\svchost.exe" OR $FileName
  LIKE "%\\rundll32.exe" OR $FileName LIKE "%\\services.exe" OR $FileName LIKE "%\\powershell.exe"
  OR $FileName LIKE "%\\regsvr32.exe" OR $FileName LIKE "%\\spoolsv.exe" OR $FileName
  LIKE "%\\lsass.exe" OR $FileName LIKE "%\\smss.exe" OR $FileName LIKE "%\\csrss.exe"
  OR $FileName LIKE "%\\conhost.exe" OR $FileName LIKE "%\\wininit.exe" OR $FileName
  LIKE "%\\lsm.exe" OR $FileName LIKE "%\\winlogon.exe" OR $FileName LIKE "%\\explorer.exe"
  OR $FileName LIKE "%\\taskhost.exe" OR $FileName LIKE "%\\Taskmgr.exe" OR $FileName
  LIKE "%\\taskmgr.exe" OR $FileName LIKE "%\\sihost.exe" OR $FileName LIKE "%\\RuntimeBroker.exe"
  OR $FileName LIKE "%\\runtimebroker.exe" OR $FileName LIKE "%\\smartscreen.exe"
  OR $FileName LIKE "%\\dllhost.exe" OR $FileName LIKE "%\\audiodg.exe" OR $FileName
  LIKE "%\\wlanext.exe") AND NOT (($FileName LIKE "C:\\Windows\\System32\\%" OR $FileName
  LIKE "C:\\Windows\\system32\\%" OR $FileName LIKE "C:\\Windows\\SysWow64\\%" OR
  $FileName LIKE "C:\\Windows\\SysWOW64\\%" OR $FileName LIKE "C:\\Windows\\winsxs\\%"
  OR $FileName LIKE "C:\\Windows\\WinSxS\\%" OR $FileName LIKE "\\SystemRoot\\System32\\%")))
