title: Microsoft Office Product Spawning Windows Shell
author: Michael Haag, Florian Roth, Markus Neis
detection:
- SELECT * FROM WINDOWSPROCESS_CREATION WHERE (($ParentImage LIKE "%\\WINWORD.EXE"
  OR $ParentImage LIKE "%\\EXCEL.EXE" OR $ParentImage LIKE "%\\POWERPNT.exe" OR $ParentImage
  LIKE "%\\MSPUB.exe" OR $ParentImage LIKE "%\\VISIO.exe" OR $ParentImage LIKE "%\\OUTLOOK.EXE")
  AND ($Image LIKE "%\\cmd.exe" OR $Image LIKE "%\\powershell.exe" OR $Image LIKE
  "%\\wscript.exe" OR $Image LIKE "%\\cscript.exe" OR $Image LIKE "%\\sh.exe" OR $Image
  LIKE "%\\bash.exe" OR $Image LIKE "%\\scrcons.exe" OR $Image LIKE "%\\schtasks.exe"
  OR $Image LIKE "%\\regsvr32.exe" OR $Image LIKE "%\\hh.exe" OR $Image LIKE "%\\wmic.exe"
  OR $Image LIKE "%\\mshta.exe" OR $Image LIKE "%\\rundll32.exe" OR $Image LIKE "%\\msiexec.exe"
  OR $Image LIKE "%\\forfiles.exe" OR $Image LIKE "%\\scriptrunner.exe" OR $Image
  LIKE "%\\mftrace.exe" OR $Image LIKE "%\\AppVLP.exe" OR $Image LIKE "%\\svchost.exe"))
