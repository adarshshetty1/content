id: 5f256e6a927d4258be0a854d7bc21b2a
name: Suspicious Rundll32 Activity
path: /Advanced Threat Detection/Windows Process Monitoring
description: Detects a suspicious exection from an uncommon folder
type: standard
author: community
entity_type: workbooks
blocks:
- type: text
  code: "|Author|References|\n                 |------|--------|\n               \
    \  |Florian Roth|None|"
- type: sql
  query: SELECT * FROM SYSMON-PROCESS WHERE ($CommandLine LIKE "%\\rundll32.exe% url.dll,%OpenURL
    %" OR $CommandLine LIKE "%\\rundll32.exe% url.dll,%OpenURLA %" OR $CommandLine
    LIKE "%\\rundll32.exe% url.dll,%FileProtocolHandler %" OR $CommandLine LIKE "%\\rundll32.exe%
    zipfldr.dll,%RouteTheCall %" OR $CommandLine LIKE "%\\rundll32.exe% Shell32.dll,%Control\_RunDLL
    %" OR $CommandLine LIKE "%\\rundll32.exe javascript:%" OR $CommandLine LIKE "%
    url.dll,%OpenURL %" OR $CommandLine LIKE "% url.dll,%OpenURLA %" OR $CommandLine
    LIKE "% url.dll,%FileProtocolHandler %" OR $CommandLine LIKE "% zipfldr.dll,%RouteTheCall
    %" OR $CommandLine LIKE "% Shell32.dll,%Control\_RunDLL %" OR $CommandLine LIKE
    "% javascript:%" OR $CommandLine LIKE "%.RegisterXLL%")
- type: signal
  DetectionName: Execution in Non-Executable Folder
  DetectionTactic: Defense Evasion
  DetectionTechnique: Masquerading
  DetectionScore: 5
  DetectionConfidence: Low
  TargetHost: $System
config: {}
