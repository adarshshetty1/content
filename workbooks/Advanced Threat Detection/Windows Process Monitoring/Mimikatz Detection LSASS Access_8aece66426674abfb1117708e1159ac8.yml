id: 8aece66426674abfb1117708e1159ac8
name: Mimikatz Detection LSASS Access
path: /Advanced Threat Detection/Windows Process Monitoring
description: Detects process access to LSASS which is typical for Mimikatz (0x1000
  PROCESS_QUERY_ LIMITED_INFORMATION, 0x0400 PROCESS_QUERY_ INFORMATION "only old
  versions", 0x0010 PROCESS_VM_READ)
type: standard
author: community
entity_type: workbooks
blocks:
- type: text
  code: "|Author|References|\n                 |------|--------|\n               \
    \  |Sherif Eldeeb|https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow<br>https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html|"
- type: sql
  query: SELECT * FROM SYSMON-PROCESS WHERE ($Action = "PROCESS_ADDED" AND $TargetImage
    LIKE "C:\\windows\\system32\\lsass.exe" AND $GrantedAccess IN ("0x1410", "0x1010"))
- type: signal
  DetectionName: Mimikatz Detection LSASS Access
  DetectionTactic: Credential Access
  DetectionTechnique: OS Credential Dumping
  DetectionScore: 5
  DetectionConfidence: Low
  TargetHost: $System
config: {}
