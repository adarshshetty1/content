id: a7157fd328fe495797362d5474286217
name: Suspicious File Download Activity by IP
path: /Advanced Threat Detection/Documents Monitoring
description: ''
type: standard
author: DNIF
entity_type: workbooks
blocks:
- type: ai
  data:
    contamination_factor: 0.001
    result_condition:
      only_anomaly: true
      return_graph_result: true
    query_data:
      stream: DOCUMENTS
      entity: $SrcIP
      feature_list:
      - distinct: $User
      - distinct: $File
      - count: $File
      - percentage_of:
        - $Status
        - PASSED
      filter_list:
      - field: $Action
        value: DOWNLOADED
        operator: '='
      duration: 7d
- type: signal
  DetectionName: Suspicious File Download Activity by IP
  DetectionTactic: Exfiltration
  DetectionTechnique: Exfiltration Over Web Service
  DetectionScore: '5'
  DetectionSeverity: Medium
  DetectionConfidence: Medium
  SuspectHost: $SrcIP
- type: text
  code: "This AI block detects the unusual/suspicious file download  activity performed\
    \ by a Source IP .In this usecase, suspicious  number of attempts performed by\
    \ a Source IP  to download a file over the last one week  will indicate the posibility\
    \ of Exfiltration att&ck  to steal data from your network.Adversaries may use\
    \ an existing, legitimate external Web service to exfiltrate data rather than\
    \ their primary command and control channel. \nThis can be mitigated by  using\
    \ web proxies to enforce an external network communication policy that prevents\
    \ use of unauthorized external services.\n"
cron: null
config:
  parameters: []
