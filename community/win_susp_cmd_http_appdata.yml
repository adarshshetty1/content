id: aa315005612c4c2fb19ed48a455b85cf
name: Command Line Execution with Suspicious URL and AppData Strings
path: /Advanced Threat Detection/Windows Process Monitoring
description: Detects a suspicious command line execution that includes an URL and
  AppData string in the command line parameters as used by several droppers (js/vbs
  > powershell)
type: standard
author: community
blocks:
- type: text
  code: "|Author|References|\n                 |------|--------|\n               \
    \  |Florian Roth|https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100<br>https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100|"
- type: sql
  query: SELECT * FROM SYSMON-PROCESS WHERE ($CommandLine LIKE "cmd.exe /c %http://%\%AppData\%"
    OR $CommandLine LIKE "cmd.exe /c %https://%\%AppData\%")
- type: signal
  DetectionName: Command Line Execution with Suspicious URL and AppData Strings
  DetectionTactic: Command and Control
  DetectionTechnique: Ingress Tool Transfer
  TargetHost: $System
  DetectionScore: 5
  DetectionConfidence: Low
