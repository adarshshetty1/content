id: d9d38e75770249b3801bb8fa4ff98042
name: Suspicious Commandline Escape
path: /test
description: Detects suspicious process that use escape characters
type: standard
author: community
blocks:
- type: text
  code: "Author: juju4 \n References: ['https://twitter.com/vysecurity/status/885545634958385153',\
    \ 'https://twitter.com/Hexacorn/status/885553465417756673', 'https://twitter.com/Hexacorn/status/885570278637678592',\
    \ 'https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html',\
    \ 'http://www.windowsinspired.com/understanding-the-command-line-string-and-arguments-received-by-a-windows-program/']"
- type: sql
  query:
  - SELECT * FROM SYSMON-PROCESS WHERE ($CommandLine LIKE "%h^t^t^p%" OR $CommandLine
    LIKE "%h"t"t"p%")
- type: signal
  DetectionName: Suspicious Commandline Escape
  DetectionTactic: Defense Evasion
  DetectionTechnique: Deobfuscate/Decode Files or Information
