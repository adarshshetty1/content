id: 3db770956895499f9065fb38d8e3a0ca
name: Certutil Encode
path: /test
description: Detects suspicious a certutil command that used to encode files, which
  is sometimes used for data exfiltration
type: standard
author: community
blocks:
- type: text
  code: "Author: Florian Roth \n References: ['https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil',\
    \ 'https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/']"
- type: sql
  query:
  - SELECT * FROM SYSMON-PROCESS WHERE ($CommandLine LIKE "certutil -f -encode %"
    OR $CommandLine LIKE "certutil.exe -f -encode %" OR $CommandLine LIKE "certutil
    -encode -f %" OR $CommandLine LIKE "certutil.exe -encode -f %")
- type: signal
  DetectionName: Certutil Encode
  DetectionTactic: Defense Evasion
  DetectionTechnique: Obfuscated Files or Information
