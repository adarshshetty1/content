id: 25c7ffcd152f4a31a18a956c759bf1d1
name: Suspicious Eventlog Clear or Configuration Using Wevtutil
path: /test
description: Detects clearing or configuration of eventlogs uwing wevtutil, powershell
  and wmic. Might be used by ransomwares during the attack (seen by NotPetya and others)
type: standard
author: community
blocks:
- type: text
  code: "Author: Ecco, Daniil Yugoslavskiy, oscd.community \n References: ['https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070/T1070.yaml',\
    \ 'https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html']"
- type: sql
  query:
  - SELECT * FROM SYSMON-PROCESS WHERE ((($Image LIKE "%\\powershell.exe" AND ($CommandLine
    LIKE "%Clear-EventLog%" OR $CommandLine LIKE "%Remove-EventLog%" OR $CommandLine
    LIKE "%Limit-EventLog%")) OR ($Image LIKE "%\\wmic.exe" AND $CommandLine LIKE
    "% ClearEventLog %")) OR ($Image LIKE "%\\wevtutil.exe" AND ($CommandLine LIKE
    "%clear-log%" OR $CommandLine LIKE "% cl %" OR $CommandLine LIKE "%set-log%" OR
    $CommandLine LIKE "% sl %")))
- type: signal
  DetectionName: Suspicious Eventlog Clear or Configuration Using Wevtutil
  DetectionTactic: Defense Evasion
  DetectionTechnique: Indicator Removal on Host
