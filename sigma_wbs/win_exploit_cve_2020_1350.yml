id: 2681db3427a34456a2868ae68cce6892
name: DNS RCE CVE-2020-1350
path: /test
description: Detects exploitation of DNS RCE bug reported in CVE-2020-1350 by the
  detection of suspicious sub process
type: standard
author: community
blocks:
- type: text
  code: "Author: Florian Roth \n References: ['https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/',\
    \ 'https://blog.menasec.net/2019/02/threat-hunting-24-microsoft-windows-dns.html']"
- type: sql
  query:
  - SELECT * FROM SYSMON-PROCESS WHERE ($ParentImage LIKE "%\\System32\\dns.exe" AND
    NOT (($Image LIKE "%\\System32\\werfault.exe" OR $Image LIKE "%\\System32\\conhost.exe"
    OR $Image LIKE "%\\System32\\dnscmd.exe")))
- type: signal
  DetectionName: DNS RCE CVE-2020-1350
  DetectionTactic: Execution
  DetectionTechnique: System Services
