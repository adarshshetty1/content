id: 63fcad77f4b84d7cae961a7690cbdec3
name: Process Dump via Comsvcs DLL
path: /test
description: Detects process memory dump via comsvcs.dll and rundll32
type: standard
author: community
blocks:
- type: text
  code: "Author: Modexp (idea) \n References: ['https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/',\
    \ 'https://twitter.com/SBousseaden/status/1167417096374050817']"
- type: sql
  query:
  - SELECT * FROM SYSMON-PROCESS WHERE (($Image LIKE "%\\rundll32.exe" OR $OriginalFileName
    = "RUNDLL32.EXE") AND ($CommandLine LIKE "%comsvcs%MiniDump%full%" OR $CommandLine
    LIKE "%comsvcs%MiniDumpW%full%"))
- type: signal
  DetectionName: Process Dump via Comsvcs DLL
  DetectionTactic: Credential Access
  DetectionTechnique: OS Credential Dumping
