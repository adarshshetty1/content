id: f6065e8758244157a284a3d32ee50986
name: Kernel Module Removal
path: /Advanced Threat Detection/Linux Process Monitoring
description: ''
type: standard
author: DNIF
blocks:
- type: sql
  query: SELECT $ProcessName,$System  FROM AUDITD WHERE $Action='PROCESS_ADDED' AND ($ProcessArgs LIKE "%rmmod%sudo%") OR ($ProcessArgs LIKE "%modprobe%sudo%" AND ($ProcessArgs LIKE "%\-\-remove%" OR $ProcessArgs LIKE "%\-r%")) GROUP BY $ProcessName,$System 
- type: signal
  DetectionName: Kernel Module Removal
  DetectionTactic: Defense Evasion
  DetectionTechnique: Kernel Modules and Extensions
  TargetHost: $System
  DetectionScore: 5
  DetectionConfidence: Low